[INFO] Scanning for projects...
[INFO] 
[INFO] -----------------< org.pilot:TransactionServicePilot >------------------
[INFO] Building TransactionServicePilot 0.0.1-SNAPSHOT
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] --- resources:3.3.1:resources (default-resources) @ TransactionServicePilot ---
[INFO] Copying 1 resource from src\main\resources to target\classes
[INFO] Copying 2 resources from src\main\resources to target\classes
[INFO] 
[INFO] --- compiler:3.14.1:compile (default-compile) @ TransactionServicePilot ---
[INFO] Nothing to compile - all classes are up to date.
[INFO] 
[INFO] --- resources:3.3.1:testResources (default-testResources) @ TransactionServicePilot ---
[INFO] Copying 1 resource from src\test\resources to target\test-classes
[INFO] 
[INFO] --- compiler:3.14.1:testCompile (default-testCompile) @ TransactionServicePilot ---
[INFO] Nothing to compile - all classes are up to date.
[INFO] 
[INFO] --- surefire:3.5.4:test (default-test) @ TransactionServicePilot ---
[INFO] Using auto detected provider org.apache.maven.surefire.junitplatform.JUnitPlatformProvider
[INFO] 
[INFO] -------------------------------------------------------
[INFO]  T E S T S
[INFO] -------------------------------------------------------
[INFO] Running org.pilot.transactionservicepilot.perf.TransactionPerformanceTest
17:32:00.503 [main] INFO org.springframework.test.context.support.AnnotationConfigContextLoaderUtils -- Could not detect default configuration classes for test class [org.pilot.transactionservicepilot.perf.TransactionPerformanceTest]: TransactionPerformanceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
17:32:00.661 [main] INFO org.springframework.boot.test.context.SpringBootTestContextBootstrapper -- Found @SpringBootConfiguration org.pilot.transactionservicepilot.TransactionServicePilotApplication for test class org.pilot.transactionservicepilot.perf.TransactionPerformanceTest
17:32:00.945 [main] INFO org.springframework.boot.devtools.restart.RestartApplicationListener -- Restart disabled due to context in which it is running

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v4.0.1)

2026-01-17T17:32:01.398+08:00  INFO 14264 --- [           main] o.p.t.perf.TransactionPerformanceTest    : Starting TransactionPerformanceTest using Java 17.0.4 with PID 14264 (started by Administrator in D:\shadow\TransactionServicePilot)
2026-01-17T17:32:01.400+08:00  INFO 14264 --- [           main] o.p.t.perf.TransactionPerformanceTest    : The following 1 profile is active: "test"
2026-01-17T17:32:02.654+08:00  INFO 14264 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2026-01-17T17:32:02.657+08:00  INFO 14264 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2026-01-17T17:32:02.889+08:00  INFO 14264 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 214 ms. Found 2 JPA repository interfaces.
2026-01-17T17:32:02.956+08:00  INFO 14264 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Multiple Spring Data modules found, entering strict repository configuration mode
2026-01-17T17:32:02.958+08:00  INFO 14264 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Redis repositories in DEFAULT mode.
2026-01-17T17:32:02.987+08:00  INFO 14264 --- [           main] .RepositoryConfigurationExtensionSupport : Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.pilot.transactionservicepilot.repository.AccountRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2026-01-17T17:32:02.988+08:00  INFO 14264 --- [           main] .RepositoryConfigurationExtensionSupport : Spring Data Redis - Could not safely identify store assignment for repository candidate interface org.pilot.transactionservicepilot.repository.TransactionRepository; If you want this repository to be a Redis repository, consider annotating your entities with one of these annotations: org.springframework.data.redis.core.RedisHash (preferred), or consider extending one of the following types with your repository: org.springframework.data.keyvalue.repository.KeyValueRepository
2026-01-17T17:32:02.988+08:00  INFO 14264 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 13 ms. Found 0 Redis repository interfaces.
2026-01-17T17:32:03.840+08:00  INFO 14264 --- [           main] org.hibernate.orm.jpa                    : HHH008540: Processing PersistenceUnitInfo [name: default]
2026-01-17T17:32:03.945+08:00  INFO 14264 --- [           main] org.hibernate.orm.core                   : HHH000001: Hibernate ORM core version 7.2.0.Final
2026-01-17T17:32:04.931+08:00  INFO 14264 --- [           main] o.s.o.j.p.SpringPersistenceUnitInfo      : No LoadTimeWeaver setup: ignoring JPA class transformer
2026-01-17T17:32:04.981+08:00  INFO 14264 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2026-01-17T17:32:05.275+08:00  INFO 14264 --- [           main] com.zaxxer.hikari.pool.HikariPool        : HikariPool-1 - Added connection conn0: url=jdbc:h2:mem:testdb user=SA
2026-01-17T17:32:05.277+08:00  INFO 14264 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2026-01-17T17:32:05.366+08:00  INFO 14264 --- [           main] org.hibernate.orm.connections.pooling    : HHH10001005: Database info:
	Database JDBC URL [jdbc:h2:mem:testdb]
	Database driver: H2 JDBC Driver
	Database dialect: H2Dialect
	Database version: 2.4.240
	Default catalog/schema: TESTDB/PUBLIC
	Autocommit mode: undefined/unknown
	Isolation level: READ_COMMITTED [default READ_COMMITTED]
	JDBC fetch size: 100
	Pool: DataSourceConnectionProvider
	Minimum pool size: undefined/unknown
	Maximum pool size: undefined/unknown
2026-01-17T17:32:06.677+08:00  INFO 14264 --- [           main] org.hibernate.orm.core                   : HHH000489: No JTA platform available (set 'hibernate.transaction.jta.platform' to enable JTA platform integration)
2026-01-17T17:32:06.746+08:00  INFO 14264 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2026-01-17T17:32:06.909+08:00  INFO 14264 --- [           main] o.s.d.j.r.query.QueryEnhancerFactories   : Hibernate is in classpath; If applicable, HQL parser will be used.
2026-01-17T17:32:08.363+08:00  WARN 14264 --- [           main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2026-01-17T17:32:09.686+08:00  INFO 14264 --- [           main] o.s.b.a.e.web.EndpointLinksResolver      : Exposing 2 endpoints beneath base path '/actuator'
2026-01-17T17:32:09.836+08:00  INFO 14264 --- [           main] o.p.t.perf.TransactionPerformanceTest    : Started TransactionPerformanceTest in 8.909 seconds (process running for 10.81)
[ERROR] Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 15.29 s <<< FAILURE! -- in org.pilot.transactionservicepilot.perf.TransactionPerformanceTest
[ERROR] org.pilot.transactionservicepilot.perf.TransactionPerformanceTest.concurrentTransactionThroughput -- Time elapsed: 5.261 s <<< ERROR!
java.util.concurrent.ExecutionException: org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update accounts set account_number=?,available_balance=?,balance=?,created_at=?,created_by=?,currency=?,status=?,updated_at=?,updated_by=?,version=? where id=? and version=?] for entity [org.pilot.transactionservicepilot.entity.Account with id '1']
	at java.base/java.util.concurrent.FutureTask.report(FutureTask.java:122)
	at java.base/java.util.concurrent.FutureTask.get(FutureTask.java:191)
	at org.pilot.transactionservicepilot.perf.TransactionPerformanceTest.concurrentTransactionThroughput(TransactionPerformanceTest.java:100)
Caused by: org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update accounts set account_number=?,available_balance=?,balance=?,created_at=?,created_by=?,currency=?,status=?,updated_at=?,updated_by=?,version=? where id=? and version=?] for entity [org.pilot.transactionservicepilot.entity.Account with id '1']
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:204)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.convertHibernateAccessException(HibernateExceptionTranslator.java:131)
	at org.springframework.orm.jpa.hibernate.HibernateExceptionTranslator.translateExceptionIfPossible(HibernateExceptionTranslator.java:109)
	at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:199)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:557)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:794)
	at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:757)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:684)
	at org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:406)
	at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:118)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:719)
	at org.pilot.transactionservicepilot.service.TransactionService$$SpringCGLIB$$0.process(<generated>)
	at org.pilot.transactionservicepilot.perf.TransactionPerformanceTest.lambda$concurrentTransactionThroughput$0(TransactionPerformanceTest.java:85)
Caused by: org.hibernate.StaleObjectStateException: Unexpected row count (expected row count 1 but was 0) [update accounts set account_number=?,available_balance=?,balance=?,created_at=?,created_by=?,currency=?,status=?,updated_at=?,updated_by=?,version=? where id=? and version=?] for entity [org.pilot.transactionservicepilot.entity.Account with id '1']
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:73)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.resultCheck(UpdateCoordinatorStandard.java:1025)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.lambda$doStaticUpdate$1(UpdateCoordinatorStandard.java:781)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.checkResults(ModelMutationHelper.java:48)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.performNonBatchedMutation(AbstractMutationExecutor.java:152)
	at org.hibernate.engine.jdbc.mutation.internal.MutationExecutorSingleNonBatched.performNonBatchedOperations(MutationExecutorSingleNonBatched.java:53)
	at org.hibernate.engine.jdbc.mutation.internal.AbstractMutationExecutor.execute(AbstractMutationExecutor.java:66)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.doStaticUpdate(UpdateCoordinatorStandard.java:776)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.performUpdate(UpdateCoordinatorStandard.java:313)
	at org.hibernate.persister.entity.mutation.UpdateCoordinatorStandard.update(UpdateCoordinatorStandard.java:231)
	at org.hibernate.action.internal.EntityUpdateAction.execute(EntityUpdateAction.java:161)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:634)
	at org.hibernate.engine.spi.ActionQueue.executeActions(ActionQueue.java:505)
	at org.hibernate.event.internal.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:381)
	at org.hibernate.event.internal.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:40)
	at org.hibernate.event.service.internal.EventListenerGroupImpl.fireEventOnEachListener(EventListenerGroupImpl.java:138)
	at org.hibernate.internal.SessionImpl.fireFlush(SessionImpl.java:1489)
	at org.hibernate.internal.SessionImpl.managedFlush(SessionImpl.java:481)
	at org.hibernate.internal.SessionImpl.flushBeforeTransactionCompletion(SessionImpl.java:2116)
	at org.hibernate.internal.SessionImpl.beforeTransactionCompletion(SessionImpl.java:2038)
	at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.beforeTransactionCompletion(JdbcCoordinatorImpl.java:410)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl.beforeCompletionCallback(JdbcResourceLocalTransactionCoordinatorImpl.java:166)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commitNoRollbackOnly(JdbcResourceLocalTransactionCoordinatorImpl.java:248)
	at org.hibernate.resource.transaction.backend.jdbc.internal.JdbcResourceLocalTransactionCoordinatorImpl$TransactionDriverControlImpl.commit(JdbcResourceLocalTransactionCoordinatorImpl.java:242)
	at org.hibernate.engine.transaction.internal.TransactionImpl.commit(TransactionImpl.java:89)
	at org.springframework.orm.jpa.JpaTransactionManager.doCommit(JpaTransactionManager.java:553)
	... 9 more
Caused by: org.hibernate.StaleStateException: Unexpected row count (expected row count 1 but was 0) [update accounts set account_number=?,available_balance=?,balance=?,created_at=?,created_by=?,currency=?,status=?,updated_at=?,updated_by=?,version=? where id=? and version=?]
	at org.hibernate.jdbc.Expectations.checkNonBatched(Expectations.java:93)
	at org.hibernate.jdbc.Expectation$RowCount.verifyOutcome(Expectation.java:170)
	at org.hibernate.engine.jdbc.mutation.internal.ModelMutationHelper.identifiedResultsCheck(ModelMutationHelper.java:60)
	... 34 more

[INFO] 
[INFO] Results:
[INFO] 
[ERROR] Errors: 
[ERROR]   TransactionPerformanceTest.concurrentTransactionThroughput:100 ? Execution org.springframework.orm.ObjectOptimisticLockingFailureException: Unexpected row count (expected row count 1 but was 0) [update accounts set account_number=?,available_balance=?,balance=?,created_at=?,created_by=?,currency=?,status=?,updated_at=?,updated_by=?,version=? where id=? and version=?] for entity [org.pilot.transactionservicepilot.entity.Account with id '1']
[INFO] 
[ERROR] Tests run: 1, Failures: 0, Errors: 1, Skipped: 0
[INFO] 
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time:  20.595 s
[INFO] Finished at: 2026-01-17T17:32:16+08:00
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:3.5.4:test (default-test) on project TransactionServicePilot: 
[ERROR] 
[ERROR] See D:\shadow\TransactionServicePilot\target\surefire-reports for the individual test results.
[ERROR] See dump files (if any exist) [date].dump, [date]-jvmRun[N].dump and [date].dumpstream.
[ERROR] -> [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoFailureException
